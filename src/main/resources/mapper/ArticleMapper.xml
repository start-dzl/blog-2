<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dzl.blog2.mapper.ArticleMapper">

    <resultMap id="ArticlePlus" type="com.dzl.blog2.model.ArticlePlus">
        <id column="id" property="id"/>
        <result column="title" property="title"/>
        <result column="author" property="author"/>
        <result column="publishDate" property="publishDate"/>
        <result column="updateDate" property="updateDate"/>
        <result column="articleContent" property="articleContent"/>
        <result column="articleTabloid" property="articleTabloid"/>
        <result column="lastArticleId" property="lastArticleId"/>
        <result column="nextArticleId" property="nextArticleId"/>
        <result column="likes" property="likes"/>
        <collection property="tags" ofType="com.dzl.blog2.entity.Tag" columnPrefix="t_">
            <id column="id" property="id"/>
            <result column="name" property="name"/>
        </collection>
    </resultMap>

    <select id="findLastArticle" resultType="com.dzl.blog2.entity.Article">
        select *
        from article
        where publish_date &lt; now()
        order by publish_date desc
        limit 1
    </select>

    <select id="findAllArticle" resultMap="ArticlePlus">
        select a.id,
        title,
        author,
        publish_date,
        update_date,
        article_content,
        article_tabloid,
        last_article_id,
        next_article_id,
        likes,
        t.id as t_id,
        t.name as t_name
        from article a
        left join article_tag t1 on a.id = t1.article_id
        left join tag t on t1.tag_id = t.id
    </select>
</mapper>
